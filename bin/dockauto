#!/usr/bin/env bash
set -euo pipefail

# ====== Step 0: dockauto wrapper ======

# dockauto version
readonly DOCKAUTO_VERSION="0.1.0"

# Find dockauto's root folder (where lib/, templates/)
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ROOT_DIR="$(cd "${SCRIPT_DIR}/.." && pwd)"

# Project root: where user's location
PROJECT_ROOT="$(pwd)"

# Export for lib to use
export DOCKAUTO_ROOT_DIR="${ROOT_DIR}"
export DOCKAUTO_VERSION
export DOCKAUTO_PROJECT_ROOT="${PROJECT_ROOT}"

# Source for primary lib
# At least we need cli & utils for Step 1+
source "${ROOT_DIR}/lib/utils.sh"
source "${ROOT_DIR}/lib/context.sh"
source "${ROOT_DIR}/lib/cli.sh"

dockauto_ctx_init
dockauto_main "$@"